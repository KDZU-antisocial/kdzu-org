---
import { getCollection } from 'astro:content';
import EventCard from './EventCard.astro';

const events = await getCollection('events');
const today = new Date();
today.setHours(0, 0, 0, 0); // Reset time to start of day

const upcomingEvents = events.filter(event => {
  const eventDate = new Date(event.data.date);
  eventDate.setHours(0, 0, 0, 0);
  return eventDate >= today;
});

const sortedEvents = upcomingEvents.sort((a, b) => {
  return new Date(a.data.date).valueOf() - new Date(b.data.date).valueOf();
});
---

<section>
  <h2>Upcoming Events</h2>
  <ul class="calendar">
    {sortedEvents.map((event) => (
      <EventCard event={event} />
    ))}
  </ul>
</section> 